<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Pincode Weather</title>
    <style>
        :root {
            --primary-bg: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #333;
            --accent-color: #007bff;
            --border-color: #e0e0e0;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            background-color: var(--primary-bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 30px;
            width: 100%;
            max-width: 900px;
            margin-bottom: 20px;
            text-align: center;
            transition: all 0.3s ease-in-out;
        }

        h1 {
            color: var(--accent-color);
            margin-bottom: 20px;
            font-size: 2.4em;
            letter-spacing: -0.5px;
        }

        .input-section {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .input-section input[type="text"] {
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            width: 180px;
            max-width: 60%;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .input-section input[type="text"]:focus {
            border-color: var(--accent-color);
        }

        .input-section button {
            padding: 12px 25px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .input-section button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .loading, .error {
            margin-top: 20px;
            font-size: 1.1em;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
            height: 1.5em; /* Reserve space */
            line-height: 1.5em;
        }

        .loading.show, .error.show {
            opacity: 1;
        }

        .loading {
            color: var(--accent-color);
        }

        .error {
            color: #dc3545;
        }

        .current-weather {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .current-weather h2 {
            font-size: 2.8em;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .current-weather .temp {
            font-size: 4.5em;
            font-weight: bold;
            margin: 10px 0;
            color: #333;
            animation: pulse 1.5s infinite alternate; /* Minimal animation */
        }

        .current-weather .description {
            font-size: 1.6em;
            margin-bottom: 15px;
            text-transform: capitalize;
            color: #555;
        }

        .current-weather .details {
            display: flex;
            gap: 30px;
            font-size: 1.15em;
            color: #777;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .weather-icon {
            font-size: 5em;
            margin-bottom: 5px;
            line-height: 1;
        }

        .forecast-section {
            margin-top: 40px;
            text-align: left;
        }

        .forecast-section h2 {
            font-size: 2em;
            margin-bottom: 25px;
            color: var(--accent-color);
            text-align: center;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            justify-content: center;
        }

        .forecast-card {
            background-color: var(--primary-bg);
            border-radius: 10px;
            padding: 18px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .forecast-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .forecast-card .day {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
            color: var(--accent-color);
        }

        .forecast-card .date {
            font-size: 0.95em;
            color: #777;
            margin-bottom: 10px;
        }

        .forecast-card .icon {
            font-size: 3em;
            margin-bottom: 5px;
            line-height: 1;
        }

        .forecast-card .temp {
            font-weight: bold;
            font-size: 1.5em;
            color: #333;
            margin-top: 8px;
        }
        .forecast-card .description {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
            text-transform: capitalize;
        }

        .hidden {
            display: none;
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.02); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            h1 {
                font-size: 2em;
            }
            .input-section {
                flex-direction: column;
                align-items: center;
            }
            .input-section input[type="text"],
            .input-section button {
                width: 90%;
                max-width: 300px;
            }
            .current-weather h2 {
                font-size: 2em;
            }
            .current-weather .temp {
                font-size: 3.5em;
            }
            .current-weather .description {
                font-size: 1.3em;
            }
            .current-weather .details {
                flex-direction: column;
                gap: 10px;
                font-size: 1em;
            }
            .weather-icon {
                font-size: 4em;
            }
            .forecast-section h2 {
                font-size: 1.6em;
            }
            .forecast-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pincode Weather Forecast</h1>

        <div class="input-section">
            <input type="text" id="pincodeInput" placeholder="Enter Pincode (e.g., 90210)">
            <button id="fetchWeatherButton">Get Weather</button>
        </div>

        <p id="loadingMessage" class="loading hidden">Fetching weather data...</p>
        <p id="errorMessage" class="error hidden"></p>

        <div id="weatherDisplay" class="hidden">
            <div class="current-weather">
                <h2 id="currentCity"></h2>
                <div class="weather-icon" id="currentIcon"></div>
                <div class="temp"><span id="currentTemp"></span>Â°C</div>
                <div class="description" id="currentDescription"></div>
                <div class="details">
                    <div>Min Temp: <span id="currentMinTemp"></span>Â°C</div>
                    <div>Max Temp: <span id="currentMaxTemp"></span>Â°C</div>
                    <div>Humidity: <span id="currentHumidity"></span>%</div>
                    <div>Wind: <span id="currentWind"></span> m/s</div>
                </div>
            </div>

            <div class="forecast-section">
                <h2>5-Day Forecast</h2>
                <div id="forecastGrid" class="forecast-grid">
                    <!-- Forecast cards will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = 'YOUR_OPENWEATHERMAP_API_KEY'; // IMPORTANT: Replace with your actual OpenWeatherMap API key
        const BASE_GEO_URL = 'https://api.openweathermap.org/geo/1.0/zip';
        const BASE_WEATHER_URL = 'https://api.openweathermap.org/data/2.5/weather';
        const BASE_FORECAST_URL = 'https://api.openweathermap.org/data/2.5/forecast';

        const pincodeInput = document.getElementById('pincodeInput');
        const fetchWeatherButton = document.getElementById('fetchWeatherButton');
        const loadingMessage = document.getElementById('loadingMessage');
        const errorMessage = document.getElementById('errorMessage');
        const weatherDisplay = document.getElementById('weatherDisplay');

        const currentCity = document.getElementById('currentCity');
        const currentIcon = document.getElementById('currentIcon');
        const currentTemp = document.getElementById('currentTemp');
        const currentDescription = document.getElementById('currentDescription');
        const currentMinTemp = document.getElementById('currentMinTemp');
        const currentMaxTemp = document.getElementById('currentMaxTemp');
        const currentHumidity = document.getElementById('currentHumidity');
        const currentWind = document.getElementById('currentWind');
        const forecastGrid = document.getElementById('forecastGrid');

        // Maps OpenWeatherMap icon codes to simple Unicode weather characters
        function getWeatherIcon(iconCode) {
            switch (iconCode) {
                case '01d': return 'â˜€ï¸'; // Clear sky day
                case '01n': return 'ðŸŒ™'; // Clear sky night
                case '02d': return 'ðŸŒ¤ï¸'; // Few clouds day
                case '02n': return 'â˜ï¸'; // Few clouds night (often few clouds at night is depicted with moon)
                case '03d':
                case '03n': return 'â˜ï¸'; // Scattered clouds
                case '04d':
                case '04n': return 'â˜ï¸â˜ï¸'; // Broken clouds
                case '09d':
                case '09n': return 'ðŸŒ§ï¸'; // Shower rain
                case '10d': return 'ðŸŒ¦ï¸'; // Rain day
                case '10n': return 'ðŸŒ§ï¸'; // Rain night
                case '11d':
                case '11n': return 'â›ˆï¸'; // Thunderstorm
                case '13d':
                case '13n': return 'â„ï¸'; // Snow
                case '50d':
                case '50n': return 'ðŸŒ«ï¸'; // Mist
                default: return 'â“'; // Unknown
            }
        }

        // Helper to format date (e.g., "Jan 1")
        function formatDate(timestamp) {
            const date = new Date(timestamp * 1000);
            return date.toLocaleDateString('en-US', { day: 'numeric', month: 'short' });
        }

        // Helper to get day of the week (e.g., "Mon")
        function getDayOfWeek(timestamp) {
            const date = new Date(timestamp * 1000);
            return date.toLocaleDateString('en-US', { weekday: 'short' });
        }

        async function fetchWeather() {
            const pincode = pincodeInput.value.trim();
            if (!pincode) {
                showError('Please enter a pincode.');
                return;
            }
            if (API_KEY === 'YOUR_OPENWEATHERMAP_API_KEY') {
                showError('Please replace "YOUR_OPENWEATHERMAP_API_KEY" in the JavaScript code with your actual OpenWeatherMap API key.');
                return;
            }

            showLoading(true);
            hideError();
            hideWeatherDisplay();

            try {
                // 1. Get coordinates (latitude, longitude) and city name from pincode
                // Assuming 'US' for pincode, adjust if other countries are needed.
                const geoResponse = await fetch(`${BASE_GEO_URL}?zip=${pincode},US&appid=${API_KEY}`);
                if (!geoResponse.ok) {
                    throw new Error(`Pincode not found or API error: ${geoResponse.statusText}`);
                }
                const geoData = await geoResponse.json();

                if (!geoData.lat || !geoData.lon) {
                    throw new Error('Could not get coordinates for the provided pincode. Please check the pincode.');
                }

                const { lat, lon, name } = geoData; // 'name' will be the city name

                // 2. Fetch current weather data
                const weatherResponse = await fetch(`${BASE_WEATHER_URL}?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`);
                if (!weatherResponse.ok) {
                    throw new Error(`Current weather API error: ${weatherResponse.statusText}`);
                }
                const weatherData = await weatherResponse.json();

                // 3. Fetch 5-day / 3-hour forecast data
                const forecastResponse = await fetch(`${BASE_FORECAST_URL}?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`);
                if (!forecastResponse.ok) {
                    throw new Error(`Forecast API error: ${forecastResponse.statusText}`);
                }
                const forecastData = await forecastResponse.json();

                renderCurrentWeather(weatherData, name);
                renderForecast(forecastData);
                showWeatherDisplay();

            } catch (error) {
                console.error('Error fetching weather:', error);
                showError(error.message || 'Failed to fetch weather data. Please check the pincode and your API key.');
            } finally {
                showLoading(false);
            }
        }

        function renderCurrentWeather(data, cityNameFromGeo) {
            currentCity.textContent = data.name || cityNameFromGeo || 'Unknown City';
            currentIcon.innerHTML = getWeatherIcon(data.weather[0].icon);
            currentTemp.textContent = Math.round(data.main.temp);
            currentDescription.textContent = data.weather[0].description;
            currentMinTemp.textContent = Math.round(data.main.temp_min);
            currentMaxTemp.textContent = Math.round(data.main.temp_max);
            currentHumidity.textContent = data.main.humidity;
            currentWind.textContent = data.wind.speed;
        }

        function renderForecast(data) {
            forecastGrid.innerHTML = ''; // Clear previous forecast

            const dailyForecasts = {}; // To store one representative entry per day
            const today = new Date().toLocaleDateString('en-US'); // Format for comparison, no time

            data.list.forEach(item => {
                const itemDate = new Date(item.dt * 1000);
                const itemDateString = itemDate.toLocaleDateString('en-US');

                // Skip today's forecast since current weather is already displayed
                if (itemDateString === today) {
                    return;
                }

                // If no entry for this day yet, or if current item is closer to noon, store it
                // This aims to get a representative daily forecast (e.g., mid-day)
                if (!dailyForecasts[itemDateString]) {
                    dailyForecasts[itemDateString] = item;
                } else {
                    const existingItemDate = new Date(dailyForecasts[itemDateString].dt * 1000);
                    if (Math.abs(itemDate.getHours() - 12) < Math.abs(existingItemDate.getHours() - 12)) {
                        dailyForecasts[itemDateString] = item;
                    }
                }
            });

            // Convert object to array and sort by date
            const sortedForecasts = Object.values(dailyForecasts).sort((a, b) => a.dt - b.dt);

            // Display up to 5 days of forecast
            sortedForecasts.slice(0, 5).forEach(item => {
                const forecastCard = document.createElement('div');
                forecastCard.classList.add('forecast-card');

                forecastCard.innerHTML = `
                    <div class="day">${getDayOfWeek(item.dt)}</div>
                    <div class="date">${formatDate(item.dt)}</div>
                    <div class="icon">${getWeatherIcon(item.weather[0].icon)}</div>
                    <div class="temp">${Math.round(item.main.temp)}Â°C</div>
                    <div class="description">${item.weather[0].description}</div>
                `;
                forecastGrid.appendChild(forecastCard);
            });
        }

        function showLoading(show) {
            loadingMessage.classList.toggle('show', show);
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('show');
        }

        function hideError() {
            errorMessage.textContent = '';
            errorMessage.classList.remove('show');
        }

        function showWeatherDisplay() {
            weatherDisplay.classList.remove('hidden');
        }

        function hideWeatherDisplay() {
            weatherDisplay.classList.add('hidden');
        }

        // Event listeners for button click and Enter key on input
        fetchWeatherButton.addEventListener('click', fetchWeather);
        pincodeInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                fetchWeather();
            }
        });
    </script>
</body>
</html>